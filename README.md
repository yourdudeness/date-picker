# Mobile-First Date Range Picker

Мобильный календарь для выбора диапазона дат на Next.js, TypeScript и Tailwind CSS.

Разработано как решение [тестового задания](https://docs.google.com/document/d/1HHEoHLjQA7E22Usa8bvTqSfdZ-a_EDE9Vuh1HBuqsf4/edit?tab=t.0).

## Основные возможности

- Mobile-first подход — разработано специально для мобильных устройств
- Плавные анимации для всех взаимодействий
- Интуитивный выбор диапазона дат
- Вертикальный скроллинг по месяцам
- Snap scrolling — автоматическое выравнивание месяцев
- Touch-friendly интерфейс с большими областями касания
- Оптимизированный рендеринг 24 месяцев (12 прошлых + 12 будущих)
- Визуальная обратная связь и индикатор текущего месяца

## Технологический стек

- Next.js 15 (App Router)
- TypeScript
- Tailwind CSS
- React 19

## UX решения и обоснование

### 1. Выбор формата: один месяц на экран

**Решение:** Показывать полный месяц, занимающий весь viewport с центрированием.

**Почему:**
- Пользователь видит всю структуру месяца сразу
- Не нужно гадать, какие даты доступны
- Естественный паттерн для календарей
- Легко ориентироваться в датах

Альтернатива с показом одной недели была бы слишком ограничена и потребовала бы много свайпов для выбора дат на расстоянии.

### 2. Вертикальный scroll вместо горизонтального

**Решение:** Месяцы скроллятся вертикально (вверх = прошлое, вниз = будущее).

**Почему:**
- Более естественно для мобильных устройств
- Горизонтальный скролл часто конфликтует с системными жестами (назад/вперёд)
- Вертикальный scroll ассоциируется с привычной лентой
- Нет конфликта со свайпом назад в браузере

### 3. Scroll snap для точного позиционирования

**Решение:** Используется CSS `scroll-snap-type: y mandatory` с `scroll-snap-align: center`.

**Почему:**
- Месяц автоматически центрируется после остановки скролла
- Не нужно аккуратно останавливать палец
- Ощущается как пагинация, но без жёсткого ограничения скролла
- Естественное поведение, как в нативных приложениях

### 4. Решение конфликта клик vs scroll

**Проблема:** При скролле можно случайно выбрать дату.

**Решение:**
- События `onClick` срабатывают только при отпускании кнопки на той же дате
- Браузер автоматически различает scroll и tap
- Добавлен `active:scale-95` для визуальной обратной связи при нажатии
- Отключён `tap-highlight` для предотвращения мерцания

**Результат:** Скролл не вызывает выбор даты, клик работает точно.

### 5. Throttling для производительности

**Решение:** Обработка scroll события с throttling (50ms) и debouncing (100ms).

**Почему:**
- Scroll события вызываются очень часто (каждые несколько ms)
- Без оптимизации возможны лаги при обновлении индикатора текущего месяца
- Throttling обеспечивает плавность, debouncing — точность финального состояния

### 6. Визуальная иерархия и обратная связь

**Решения:**
- Выбранные даты: увеличены (`scale-110`), синий фон, белый текст, тень
- Диапазон: светло-синий фон для дат между начальной и конечной
- Сегодня: серый фон, жирный шрифт
- Hover states: светло-серый фон (для desktop превью)
- Active state: уменьшение (`scale-95`) при нажатии
- Transitions: плавные переходы (200ms) для всех изменений состояний

**Почему:**
- Пользователь всегда понимает, что он выбрал
- Визуальная обратная связь делает интерфейс живым
- Нет сомнений в том, какие даты выбраны

### 7. Фиксированный header с выбранным диапазоном

**Решение:** Sticky header с blur-эффектом и отображением выбранных дат.

**Почему:**
- Всегда видно, что уже выбрано
- Не нужно скроллить назад, чтобы вспомнить выбранные даты
- Blur-эффект дает ощущение глубины
- Кнопка "Очистить" всегда доступна

### 8. Индикатор текущего месяца

**Решение:** Плавающая капсула внизу экрана с названием месяца в viewport.

**Почему:**
- При быстром скролле легко потерять ориентацию
- Индикатор показывает, на каком месяце пользователь остановился
- Не мешает выбору дат (расположен внизу)
- Полупрозрачный фон для сохранения читаемости

### 9. Оптимизация для touch-устройств

**Решения:**
```css
-webkit-tap-highlight-color: transparent;  /* Убрать системное выделение */
-webkit-overflow-scrolling: touch;         /* Smooth scroll на iOS */
overscroll-behavior-y: contain;            /* Предотвратить pull-to-refresh */
touch-action: pan-y;                       /* Только вертикальный скролл */
```

**Почему:**
- Системное выделение мешает пользовательскому дизайну
- iOS требует специальный флаг для smooth scroll
- Pull-to-refresh может случайно сработать при скролле в начало
- `pan-y` предотвращает горизонтальные жесты

### 10. 24 месяца рендера (не бесконечный скролл)

**Решение:** Рендерить 12 прошлых месяцев + текущий + 11 будущих.

**Почему:**
- Проще реализация, нет сложности с виртуализацией
- Достаточно для большинства сценариев использования
- Оптимальный баланс производительности и функциональности
- При необходимости можно добавить виртуализацию (react-window)

## Что было приоритетом

1. UX прежде всего — плавность, естественность, как нативное приложение
2. Решение проблемы scroll vs click — чтобы скролл не вызывал клики
3. Mobile-first — всё разработано под палец, а не мышку
4. Производительность — throttling, оптимизированный рендеринг
5. Визуальная понятность — всегда ясно, что выбрано и где находишься

## Быстрый старт

### Установка
```bash
npm install
```

### Разработка
```bash
npm run dev
```

### Production build
```bash
npm run build
npm start
```

## Структура проекта
```
├── app/
│   ├── layout.tsx          # Root layout с mobile viewport настройками
│   ├── page.tsx            # Главная страница с DateRangePicker
│   └── globals.css         # Глобальные стили, mobile оптимизации
├── components/
│   └── DateRangePicker.tsx # Основной компонент календаря
└── lib/
    └── dateUtils.ts        # Утилиты для работы с датами
```

## Mobile-specific оптимизации

- `viewport` настройки для предотвращения zoom на input
- `user-scalable=no` для fixed UI
- `overscroll-behavior: contain` — отключение pull-to-refresh
- `touch-action: pan-y` — только вертикальный скролл
- `-webkit-overflow-scrolling: touch` — smooth scroll на iOS
- Большие touch targets (минимум 44x44px по Apple HIG)

## Что можно улучшить

- Виртуализация для поддержки неограниченного количества месяцев
- Локализация (i18n) для разных языков (сейчас только русский)
- Горизонтальные свайпы для переключения между месяцами
- Keyboard navigation для accessibility и desktop пользователей
- Preset ranges: быстрый выбор "Последние 7 дней", "Этот месяц" и т.д.
- Минимальная/максимальная дата: ограничение доступных дат
- Disabled даты: возможность отключить определённые даты

## Технические решения

### Почему Next.js App Router?

- Server Components по умолчанию (меньше JS на клиенте)
- Встроенная оптимизация производительности
- Простой деплой на Vercel
- TypeScript из коробки

### Почему Tailwind CSS?

- Быстрая разработка с утилитами
- Минимальный размер CSS в продакшене (JIT)
- Responsive design из коробки
- Лёгкая кастомизация

### Почему вертикальный скролл?

- Естественнее на мобильных
- Нет конфликта с browser navigation
- Более предсказуемое поведение
- Лучше для длинных списков (месяцев)

## Лицензия

MIT